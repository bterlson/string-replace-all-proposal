<!DOCTYPE html>
<meta charset="utf-8">
<pre class="metadata">
title: String.prototype.replaceAll
status: proposal
stage: 1
location: https://tc39.github.io/proposal-string-replace-all/
copyright: false
contributors: Mathias Bynens
</pre>
<script src="ecmarkup.js" defer></script>
<link rel="stylesheet" href="ecmarkup.css">
<style>
  ins.block {
    font-weight: bold;
    font-style: italic;
  }
  hr {
    height: 0.25em;
    background: #ccc;
    border: 0;
    margin: 2em 0;
  }
</style>

<emu-clause id="sec-string.prototype.replaceall">
  <h1>String.prototype.replaceAll ( _searchValue_, _replaceValue_ )</h1>
  <p>When the `replaceAll` method is called with arguments _searchValue_ and _replaceValue_, the following steps are taken:</p>
  <emu-alg>
    1. Let _O_ be ? RequireObjectCoercible(*this* value).
    1. If _searchValue_ is neither *undefined* nor *null*, then
      1. Let _isRegExp_ be ? IsRegExp(_searchValue_).
      1. If _isRegExp_ is *true*, then
        1. Let _flags_ be _searchValue_.[[OriginalFlags]].
        1. If _flags_ does not contain `"g"`, then
          1. Set _flags_ to a copy of _flags_.
          1. Append `"g"` to _flags_.
      1. Else,
        1. Let _searchString_ be ? ToString(_searchValue_).
        1. Set _escapedPattern_ to EscapeRegExpPattern(_src_, `"g"`).
        1. Set _searchValue_ to ? RegExpCreate(_escapedPattern_, `"g"`).
      1. Assert: ? IsRegExp(_searchValue_) is *true*.
      1. Let _replacer_ be ? GetMethod(_searchValue_, @@replace).
      1. If IsCallable(_replacer_) is *true*, then
        1. Return ? Call(_replacer_, _searchValue_, &laquo; _O_, _replaceValue_ &raquo;).
      1. Else, throw a *TypeError* exception.
  </emu-alg>
  <emu-note>
    <p>The `replaceAll` function is intentionally generic; it does not require that its *this* value be a String object. Therefore, it can be transferred to other kinds of objects for use as a method.</p>
  </emu-note>
